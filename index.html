<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE-edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Àudio i Vídeo</title>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Deixem l'etiqueta audio sense controls. Veieu que desapareix tot. -->
    <audio id="player">
        <source src="media/techbg.mp3" type="audio/mp3">
        Ho sento, el teu navegador no suporta àudio d'HTML5.
    </audio>
    <!-- Afegim una capa que mostra si l'àudio s'està reproduint: ho fem amb una animació CSS. -->
    <div class="fonsPlayer">
        <div class="ocean">
            <div class="wave"></div>
            <div class="wave"></div>
        </div>
        <div class="audioControls">
            <!-- Control de reproducción y reinicio con cambio dinámico de icono -->
            <button type="button" onclick="togglePlayPause();">
                <span id="playPauseIcon" class="material-symbols-outlined">
                    play_arrow
                </span>
            </button>
            <div class="progressTools">
                <!-- Control deslizante de progreso -->
                <div class="progressSlider">
                    <input type="range" id="progressSlider" min="0" step="1" value="0" oninput="seekAudio(this.value);">
                </div>
                <!-- Control reinicio -->
                <button type="button" onclick="resetAudio();">
                    <span class="material-symbols-outlined">
                        replay
                    </span>
                </button>
                <!-- Control deslizante de volumen -->
                <div class="volumeSlider">
                    <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1"
                        oninput="adjustVolume(this.value);">
                </div>
            </div>
        </div>
    </div>

    <!-- Elemento para mostrar el nombre del archivo -->
    <div id="songName"></div>

    <!-- Recordeu que heu de seguir les lleis en matèria de propietat intelectual.
         En aquest cas, cal nomenar i enllaçar l'autor i el tipus de llicència. 
    -->
    <div style="padding: 1em; margin-bottom: 1em; border: 1px; background-color: #eee;">
        "<a rel="nofollow" href="https://timtaj.com/royalty-free-music/background-technology">Background Technology</a>"
        by <a rel="nofollow" href="https://freemusicarchive.org/music/timtaj/contact">Taj Tim</a>
        is licensed under <a rel="nofollow"
            href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Attribution-NonCommercial-NoDerivatives 4.0
            International License</a>
    </div>
    <div style="padding: 1em; margin-bottom: 1em; border: 1px; background-color: #eee;">
        "Animació CSS de <a rel="nofollow" href="https://codepen.io/tedmcdo">Ted MacDonald</a>:
        a CodePen <a rel="nofollow" href="https://codepen.io/tedmcdo/pen/PqxKXg">CSS & SVG Waves Animation</a>
    </div>
    <!-- Cal seleccionar l'element d'àudio. -->
    <script>
        let audio = document.getElementById('player');
        let playPauseButton = document.getElementById('playPauseIcon');
        let isPlaying = false;
        let waves = document.querySelectorAll('.wave');
        let songNameElement = document.getElementById('songName');

        function togglePlayPause() {
            if (isPlaying) {
                audio.pause();
                playPauseButton.textContent = 'play_arrow';
                for (var i = 0; i < waves.length; i++) {
                    waves[i].classList.remove('playing');
                }
            } else {
                audio.play();
                playPauseButton.textContent = 'pause';
                for (var i = 0; i < waves.length; i++) {
                    waves[i].classList.add('playing');
                }
            }
            isPlaying = !isPlaying;
        }

        function resetAudio() {
            audio.currentTime = 0;
        }

        function adjustVolume(volume) {
            audio.volume = parseFloat(volume);
        }

        function seekAudio(position) {
            audio.currentTime = position;
        }

        audio.addEventListener('timeupdate', function () {
            let currentTime = audio.currentTime;
            document.getElementById('progressSlider').value = currentTime;
        });

        // Obtén el nombre del archivo desde la URL del recurso de audio
        const audioSource = audio.querySelector('source');
        const audioURL = audioSource.getAttribute('src');
        const fileName = audioURL.substring(audioURL.lastIndexOf('/') + 1);
        songNameElement.textContent = "Titulo Musica: " + fileName;
    </script>
</body>

</html>
